# RNA-seq Isoform and Gene-level Expression Analysis Pipeline



This pipeline processes paired-end RNA-seq data starting from raw FASTQ files and produces:

* Transcript-level quantification (TPM and length-scaled counts)
* Gene-level expression matrices
* PCA for sample-level quality assessment
* Differential gene expression results between experimental conditions

The workflow is suitable for bulk RNA-seq experiments with biological replicates and is optimized for downstream statistical analysis using **edgeR** and **limma**.

---

### Dataset

**GEO Accession:** GSE259357
**Organism:** Mouse (mm10)
**Experimental Design:**

* KRAS pancreatic organoids (2 replicates)
* KRAS pancreatic organoids overexpressing SPIB (2 replicates)

---

### Software and Environment

* **Conda** (recommended)
* **Python:** 3.9
* **Key tools:**

  * Salmon
  * Trim Galore
  * FastQC
* **R / Bioconductor packages:**

  * tximport
  * edgeR
  * limma
  * sva
  * ggplot2, ggrepel, ggfortify
  * rtracklayer, data.table

---

### Pipeline Steps

#### 1. Environment Setup

A dedicated conda environment is created and activated, followed by installation of Salmon and Trim Galore.

#### 2. Quality Control and Trimming

Raw paired-end FASTQ files are adapter-trimmed and quality-checked using **Trim Galore** with FastQC reports generated automatically.

#### 3. Isoform Quantification

Trimmed reads are quantified against a pre-built **mm10 Salmon index** using quasi-mapping with validation enabled. Output includes transcript-level abundance and count estimates.

#### 4. Transcript Annotation

Transcript IDs are annotated using the corresponding GTF file to associate transcript names with Salmon quantification results.

#### 5. Expression Matrix Construction

* **Transcript-level matrices:** generated using `tximport` with length-scaled TPM-based counts
* **Gene-level matrices:** generated by summarizing transcript counts using transcript-to-gene mappings from the GTF file

Both count and TPM matrices are exported as TSV files.

#### 6. Filtering and Normalization

Lowly expressed genes are filtered (genes expressed in â‰¥80% of samples). Remaining genes are normalized using **TMM** normalization followed by **voom** transformation.

#### 7. Exploratory Analysis

Principal Component Analysis (PCA) is performed on voom-normalized expression values to assess sample clustering and replicate consistency.

#### 8. Differential Expression Analysis

Differential gene expression between **KRAS_SPIB** and **KRAS** conditions is tested using a linear model with empirical Bayes moderation. Full result tables are exported for downstream interpretation.

---

### Outputs

* `quant.sf` files (Salmon output per sample)
* Transcript-level count and TPM matrices
* Gene-level count and TPM matrices
* PCA plot (PDF)
* Differential expression results (`.tsv`)

**Pritha Saha**
PhD Researcher | Computational & Systems Biology
